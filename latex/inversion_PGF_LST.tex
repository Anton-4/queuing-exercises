\section{ Inversion of PGFs and LSTs }

\subsection*{ Theory }

$M/E_r/1$, r phases, mean value $\frac{1}{\mu }=\frac{r}{r\cdot u}$

LST of service times:
\begin{align*}
B^{{\ast }}\left(s\right)&=\left(\frac{r\cdot u}{s+r\cdot u}\right)^{r}
\end{align*}

PGF of X
\begin{align*}
x\left(z\right)&=\sum _{{i=0}}^{n}x_{i}z^{i}\\
&=\sum _{{i=0}}^{n}Pr\left[x=i\right]z_{i}
\end{align*}

M/G/1, PGF of system content:
\begin{align*}
S\left(z\right)&=\left(1-\rho \right)\cdot \frac{B^{{\ast }}\left(\lambda \left(1-z\right)\right)\left(1-z\right)}{B^{{\ast }}\left(\lambda \left(1-z\right)\right)-z}&& \text{-  $B^{{\ast }}=$ LST of service time -}
\end{align*}

\subsection*{ 1. }

\subsubsection*{ a) }
\begin{align*}
S\left(z\right)&=\sum _{{i=0}}^{\infty }s\left(i\right)z^{i}&& \text{-  definition PGF -}\\
s\left(i\right)&=?
\end{align*}

\textbf{example for M/Er/1}
\begin{align*}
S\left(z\right)&=\frac{1-\rho }{1-\rho \cdot z}=\left(1-\rho \right)\frac{1}{1-\rho \cdot z}\\
&=\left(1-\rho \right)\cdot \left(\sum _{{i=0}}^{\infty }\rho ^{i}z^{i}\right)\\
&=\sum _{{i=0}}^{\infty }\left(1-\rho \right)\rho ^{i}z^{i}
\end{align*}

\begin{align*}
B^{{\ast }}\left(s\right)&=\left(\frac{z\cdot u}{s+z\cdot u}\right)^{z}&& \text{-  see theory -}\\
S\left(z\right)&=\left(1-\rho \right)\cdot \frac{\left(2\mu \right)^{2}\cdot \left(1-z\right)}{\left(2\mu \right)^{2}-z\cdot \left(\lambda \cdot \left(1-z\right)+2\mu \right)^{2}}&& \text{-  see theory -}\\
&=\left(1-\rho \right)\cdot \frac{4\mu ^{2}\cdot \left(1-z\right)}{4\mu ^{2}-z\cdot \left(\left(\lambda \cdot \left(1-z\right)\right)^{2}+4\mu ^{2}\right)+2\cdot \lambda \left(1-z\right)\cdot 2\mu }\\
&=\left(1-\rho \right)\cdot \frac{\mu ^{2}\cdot 4\left(1-z\right)}{\mu ^{2}\left(4-\frac{z\cdot \lambda ^{2}\cdot \left(1-z\right)^{2}}{\mu ^{2}}\right)-4z-\frac{4z\cdot \lambda \left(1-z\right)}{\mu }}\\
&=\left(1-\rho \right)\cdot \frac{4\left(1-z\right)}{4-z\cdot \rho ^{2}\cdot \left(1-z\right)^{2}-4z-4z\cdot \rho \left(1-z\right)}\\
&=\frac{4\left(1-\rho \right)}{4-z\cdot \rho ^{2}\left(1-z\right)-4z\cdot \rho }\\
&=\frac{4\left(1-\rho \right)}{4-\left(\rho ^{2}+4\rho \right)z+\rho ^{2}z^{2}}
\end{align*}

We want to split up in partial fractions $\rightarrow$ find zeros of denominator(poles) of $S\left(z\right)$:
\begin{align*}
\rho ^{2}z^{2}-\left(\rho ^{2}+4\rho \right)z+4&=0\\
D&= b^2 - 4 \cdot a \cdot c\\
&=\left(\rho ^{2}+4\rho \right)^{2}-4\rho ^{2}\cdot 4\\
&=\rho ^{4}+8\rho ^{3}+16\rho ^{2}-16\rho ^{2}\\
&=\rho ^{4}+8\rho ^{3}
\end{align*}
\begin{align*}
z_{{1,2}}&=\frac{-b \pm \sqrt{D}}{2a}\\
&=\frac{\rho ^{2}+4\rho \pm \sqrt{\rho ^{4}+8\rho ^{3}}}{2\rho ^{2}}\\
&=\frac{\rho +4\pm \sqrt{\rho ^{2}+8\rho }}{2\rho }
\end{align*}

(p 5.16) assume:
\begin{align*}
S\left(z\right)&=A_{1}\cdot \frac{1}{1-\frac{z}{z_{1}}}+A_{2}\cdot \frac{1}{1-\frac{z}{z_{2}}}\\
&=A_{1}\cdot \sum _{{i=0}}^{\infty }\left(\frac{z}{z_{1}}\right)^{i}+A_{2}\cdot \sum _{{i=0}}^{\infty }\left(\frac{z}{z_{2}}\right)^{i}\\
&=\sum_{i=0}^{\infty } A_{1} \cdot z^i \cdot z_1^{-i}+\sum_{i=0}^{\infty } A_2 \cdot z^i \cdot z_2^{-i}\\
&=\sum_{{i=0}}^{\infty }\left(A_{1}\cdot z_{1}^{{-i}}+A_{2}\cdot z_{2}^{{-i}}\right)z^{i}
\end{align*}
We need to find $A_{1},A_{2}$
\begin{align*}
S\left(z\right)&=A_{1}\cdot \frac{z_{1}}{z_{1}-z}+A_{2}\cdot \frac{z_{2}}{z_{2}-z}\\
&=\frac{A_{1}\left(z_{2}-z\right)z_{1}+A_{2}\left(z_{1}-z\right)z_{2}}{\left(z_{1}-z\right)\left(z_{2}-z\right)}\\
&=\frac{A_{1}\left(z_{2}-z\right)z_{1}+A_{2}\left(z_{1}-z\right)z_{2}}{\left(z-z_{1}\right)\left(z-z_{2}\right)}
\end{align*}
we know we miss a factor in the denominator:
\begin{align*}
Denominator\left(z\right)&={\bf \rho} ^{2} \left(z-z_{1}\right)\left(z-z_{2}\right)
\end{align*}
Thus:
\begin{align*}
A_{1}\left(z_{2}-z\right)z_{1}+A_{2}\left(z_{1}-z\right)z_{2}&=\frac{4\left(1-\rho \right)}{\rho ^{2}}
\end{align*}
\begin{align*}
z_{1}\cdot z_{2}&=\frac{\left(\rho +4\right)^{2}-\left(\sqrt{\rho ^{2}+8\rho }\right)^{2}}{4\rho ^{2}}\\
&=\frac{\rho ^{2}+16+8\rho -\rho ^{2}-8\rho }{4\rho ^{2}}\\
&=\frac{16}{4\rho ^{2}}\\
&=\frac{4}{\rho ^{2}}
\end{align*}
We intelligently choose values of z to make one of the terms 0 in:
\begin{align*}
A_{1}\left(z_{2}-z\right)z_{1}+A_{2}\left(z_{1}-z\right)z_{2}&=\left(4\left(1-\rho \right)\right)
\end{align*}
$z=z_{1}$:
\begin{align*}
A_{1}\left(z_{2}-z_{1}\right)z_{1}&=\frac{4\left(1-\rho \right)}{\rho ^{2}}\\
A_{1}&=\frac{4\left(1-\rho \right)}{\rho ^{2}z_{1}\left(z_{2}-z_{1}\right)}&& \text{-  $z_{2}=\frac{4}{\rho ^{2}\cdot z_{1}}$ -}
\end{align*}
$z=z_{2}$:
\begin{align*}
A_{2}\left(z_{1}-z_{2}\right)z_{2}&=\frac{4\left(1-\rho \right)}{\rho ^{2}}\\
A_{2}&=\frac{\left(1-\rho \right)z_{1}}{z_{1}-z_{2}}
\end{align*}

\subsubsection*{ b) }
\begin{align*}
Pr\left[S> i\right]&=\sum _{{n=i+1}}^{\infty }s\left(n\right)\\
&=\sum _{{n=i+1}}^{\infty }\left(A_{1}z_{1}^{{-n}}+A_{2}z_{2}^{{-n}}\right)\\
&=\sum _{{n=i+1}}^{\infty }\left(1-\rho \right)\left(\frac{z_{2}\cdot z_{1}^{{-n}}-z_{1}\cdot z_{2}^{{-n}}}{z_{2}-z_{1}}\right)\\
&=\frac{1-\rho }{z_{2}-z_{1}}\left(\sum _{{n=0}}^{\infty }z_{2}\cdot \left(\frac{1}{z_{1}}\right)^{{n+i+1}}-\sum _{{n=0}}^{\infty }z_{1}\cdot \left(\frac{1}{z_{2}}\right)^{{n+i+1}}\right)\\
&=\frac{1-\rho }{z_{2}-z_{1}}\left(z+2z_{1}^{{-i-1}}\sum _{{n=0}}^{\infty }\left(\frac{1}{z_{1}}\right)^{n}-z_{1}z_{2}^{{-i-1}}\sum _{{n=0}}^{\infty }z_{1}\cdot \left(\frac{1}{z_{2}}\right)^{{n}}\right)\\
&=\frac{1-\rho }{z_{2}-z_{1}}\left(z+2z_{1}^{{-i-1}}\frac{1}{1-\frac{1}{z_{1}}}-z_{1}z_{2}^{{-i-1}}\frac{1}{1-\frac{1}{z_{2}}}\right)\\
&=\frac{1-\rho }{z_{2}-z_{1}}\frac{z+2z_{1}^{{-i-1}}}{z_{1}-1}-\frac{z_{1}z_{2}^{{-i-1}}}{z_{2}-1}
\end{align*}

\subsubsection*{ c) }
\begin{align*}
D^{{\ast }}\left(s\right)&=\left(1-\rho \right)\frac{s\cdot \left(\frac{2\mu }{2\mu +s}\right)^{2}}{s-\lambda +\lambda \left(\frac{2\mu }{2\mu +s}\right)^{2}} && \text{- definition LST of sojourn time -}\\
&=\left(1-\rho \right)\frac{s\cdot 4\mu ^{2}}{\left(s-\lambda \right)\left(2\mu +s\right)^{2}+\lambda 4\mu ^{2}}\\
&=\left(1-\rho \right)\frac{4\mu ^{2}s}{4\mu ^{2}s+4\mu ^{2}s+s^{3}-\lambda 4\mu ^{2}-\lambda 4\mu s-\lambda s^{2}+\lambda 4\mu ^{2}}\\
&=\left(1-\rho \right)\frac{4\mu ^{2}}{s^{2}+\left(4\mu -\lambda \right)s+4\mu \left(\mu -\lambda \right)}
\end{align*}

poles of denominator:
\begin{align*}
D&=\left(4\mu -\lambda \right)^{2}-4\cdot 1\cdot 4\mu \left(\mu -\lambda \right)\\
&=16\mu ^{2}+\lambda ^{2}-8\mu \cdot \lambda -16\mu ^{2}+16\mu \lambda \\
&=\lambda ^{2}+8\mu \lambda 
\end{align*}
\begin{align*}
s_{{1,2}}&=\frac{-\left(4\mu -\lambda \right)\pm \sqrt{\lambda ^{2}+8\mu \cdot \lambda }}{2}
\end{align*}
we know: $1\cdot \left(s-s_{1}\right)\left(s-s_{2}\right)=$ denominator  of $D^{{\ast }}\left(s\right)$
\begin{align*}
D^{{\ast }}\left(s\right)&=A_{1}\cdot \frac{s_{1}}{s-s_{1}}+A_{2}\cdot \frac{s_{2}}{s-s_{2}}\\
&=\frac{A_{1}\cdot s_{1}\left(s-s_{2}\right)+A_{2}\cdot s_{2}\left(s-s_{1}\right)}{\left(s-s_{1}\right)\left(s-s_{2}\right)}
\end{align*}
\begin{align*}
A_{1}s_{1}\left(s-s_{2}\right)+A_{2}s_{2}\left(s-s_{1}\right)&=\frac{\left(1-\rho \right)4\mu ^{2}}{1}\\
A_{1}s_{1}\left(s_{1}-s_{2}\right)&=\left(1-\rho \right)4\mu ^{2}\\
A_{1}&=\frac{\left(1-\rho \right)4\mu ^{2}}{s_{1}\left(s_{1}-s_{2}\right)}\\
A_{2}s_{2}\left(s_{2}-s_{1}\right)&=\left(1-\rho \right)4\mu ^{2}\\
A_{2}&=\frac{\left(1-\rho \right)4\mu ^{2}}{s_{2}\left(s_{2}-s_{1}\right)}
\end{align*}
\begin{align*}
D^{{\ast }}\left(s\right)&=-A_{1}\cdot \frac{-s_{1}}{-s_{1}+s}+-A_{2}\frac{-s_{2}}{-s_{2}+s}
\end{align*}
\begin{align*}
d\left(t\right)&=-A_{1}\left(-s_{1}\right)e^{{s_{1}t}}-A_{2}\left(-s_{2}\right)e^{{s_{2}t}}\\
&=A_{1}s_{1}e^{{s_{1}t}}+A_{2}s_{2}e^{{s_{2}t}}
\end{align*}
hyperexponential distribution with 2 phases;
\begin{itemize}
\item  $A_{i}$ is the prob of phase i
\item  $s_{i}$ is the rate if the i-th exponential
\item  see p 5.23-24
\end{itemize}

\subsection*{ 3. }

\subsubsection*{ a) }

\begin{align*}
X_{c}\left(z\right)&=\sum _{{i=0}}^{n}Pr\left[x> i\right]z^{i}\\
X\left(z\right)&=\sum _{{i=0}}^{n}Pr\left[x=i\right]z^{i}\\
Pr\left[x> i\right]&=\sum _{{i=0}}^{\infty }Pr\left[x=n\right]
\end{align*}
\begin{align*}
X_{c}\left(z\right)&=\sum _{{i=0}}^{\infty }\left(\sum _{{n=i+1}}^{\infty } Pr\left[x=n\right] z^{i}\right)\\
&=\sum _{{n=1}}^{\infty }\left(\sum _{{i=0}}^{{n-1}}Pr\left[x=n\right] z^{i}\right)\\
&=\sum _{{n=1}}^{\infty }Pr\left[X=n\right]\sum _{{i=0}}^{{n-1}}z^{i}\\
&=\sum _{{n=0}}^{\infty }Pr\left[X=n\right]\frac{1-z^{n}}{1-z} && \text{ - n=0 because product is 0 for n=0 - }\\
&=\frac{1}{1-z} \sum _{{n=0}}^{\infty }Pr\left[X=n\right](1-z^{n})\\
&=\frac{1-x\left(z\right)}{1-z}
\end{align*}

\subsubsection*{ b) }

the singularities are the same